import{_ as T,m as B,a as k,u as _,b as v,c as y,o as t,d as u,e as p,V as L,f as c,g as a,w as n,h as I,F as A,r as $,i as g,j as l,t as d,k as V,l as h,n as S,p as O,q as P,s as w,v as M,x as N,y as x,z as F,A as j,B as z,C as f,D}from"./admin-30c006a2.js";const E={name:"AdminStatusList",components:{CloseButton:T},data(){return{mdiCloseCircleOutline:B}},computed:{...k(_,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...v(_,["loadTable","librarianTask"]),indeterminate:e=>!e.preactive&&+e.total==0,progress(e){return e.preactive||+e.total==0?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")}}},U=e=>(O("data-v-24483090"),e=e(),P(),e),q={key:0},G=U(()=>g("h4",null,"Librarian Tasks",-1)),R={nav:"",class:"statusItem"},H={class:"statusItemTitle"},J={key:0};function K(e,o,r,C,m,i){const b=T;return t(),u(A,null,[e.show?(t(),p(L,{key:0})):c("",!0),a(S,{onClick:i.load},{default:n(()=>[a(I,null,{default:n(()=>[e.show?(t(),u("div",q,[a(b,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:i.clear},null,8,["onClick"]),G,(t(!0),u(A,null,$(e.librarianStatuses,s=>(t(),p(I,{key:`${s.type} ${s.name}`},{default:n(()=>[g("div",R,[g("div",H,[l(d(s.type)+" "+d(s.name)+" ",1),+s.total?(t(),u("span",J,d(s.complete)+"/"+d(s.total),1)):c("",!0)]),a(V,{indeterminate:i.indeterminate(s),"model-value":i.progress(s),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(t(),p(h,{key:1,id:"noTasksRunning"},{default:n(()=>[l(" No librarian tasks running ")]),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Q=y(E,[["render",K],["__scopeId","data-v-24483090"]]);const W={name:"AdminMenu",components:{AdminStatusList:Q},props:{menu:{type:Boolean,default:!0}},data(){return{mdiBookAlert:w,mdiOpenInNew:M,mdiDatabaseClockOutline:N,mdiCogOutline:x}},computed:{...F(j,["isUserAdmin"]),...k(_,["unseenFailedImports"])},methods:{...v(_,["clearFailedImports","librarianTask"])}},X={key:0},Y={key:0};function Z(e,o,r,C,m,i){const b=z("AdminStatusList");return e.isUserAdmin?(t(),u("div",X,[r.menu?(t(),u("div",Y,[a(S,{onClick:o[0]||(o[0]=s=>e.librarianTask("poll"))},{default:n(()=>[a(h,null,{default:n(()=>[a(f,null,{default:n(()=>[l(d(m.mdiDatabaseClockOutline),1)]),_:1}),l("Poll All Libraries")]),_:1})]),_:1}),a(S,{to:{name:"admin"}},{default:n(()=>[a(h,null,{default:n(()=>[a(f,null,{default:n(()=>[l(d(m.mdiCogOutline),1)]),_:1}),l("Admin Panel "),e.unseenFailedImports?(t(),p(f,{key:0,id:"failedImportsIcon",title:"New Failed Imports"},{default:n(()=>[l(d(m.mdiBookAlert),1)]),_:1})):c("",!0)]),_:1})]),_:1})])):c("",!0),a(b)])):c("",!0)}const ee=y(W,[["render",Z],["__scopeId","data-v-24e129a8"]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));const te={name:"AdminSettingsButtonProgress",computed:{...k(_,["librarianStatuses"]),progressEnabled:function(){return this.librarianStatuses.length>0},progress:function(){let e=0,o=0;if(!(!this.librarianStatuses||this.librarianStatuses.length===0)){for(const r of this.librarianStatuses){if(r.total===null||r.total===void 0||r.complete===void 0)return;e+=+r.complete,o+=+r.total}if(!(o<=0))return 100*e/o}}},created(){this.loadTable("LibrarianStatus")},methods:{...v(_,["loadTable"])}};function ae(e,o,r,C,m,i){return i.progressEnabled?(t(),p(D,{key:0,indeterminate:i.progress==null,"model-value":i.progress,class:"progress",size:"36","aria-label":"`Librarian tasks in progress ${Math.round(progress)}%`"},null,8,["indeterminate","model-value"])):c("",!0)}const ne=y(te,[["render",ae],["__scopeId","data-v-8db54809"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{re as a,ie as b};
