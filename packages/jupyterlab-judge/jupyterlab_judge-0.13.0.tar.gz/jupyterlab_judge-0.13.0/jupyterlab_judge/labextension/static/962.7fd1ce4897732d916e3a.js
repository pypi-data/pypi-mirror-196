"use strict";(self.webpackChunkjupyterlab_judge=self.webpackChunkjupyterlab_judge||[]).push([[962],{962:(t,e,s)=>{s.d(e,{B5:()=>f,F1:()=>v});var n=s(1526),a=s(1840);const o=Date.now,r=Math.floor,i=(Math.ceil,Math.abs,Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,Number.isNaN,Math.pow,Math.sign,()=>new Map),h=()=>new Set,c=Array.from;Array.isArray;class u{constructor(){this._observers=i()}on(t,e){((t,e,s)=>{let n=t.get(e);return void 0===n&&t.set(e,n=s()),n})(this._observers,t,h).add(e)}once(t,e){const s=(...n)=>{this.off(t,s),e(...n)};this.on(t,s)}off(t,e){const s=this._observers.get(t);void 0!==s&&(s.delete(e),0===s.size&&this._observers.delete(t))}emit(t,e){return c((this._observers.get(t)||i()).values()).forEach((t=>t(...e)))}destroy(){this._observers=i()}}Object.assign;const d=Object.keys,l=t=>d(t).length,g=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),y=(t,e)=>{if(null==t||null==e)return((t,e)=>t===e)(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;break;case Set:if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;break;case Map:if(t.size!==e.size)return!1;for(const s of t.keys())if(!e.has(s)||!y(t.get(s),e.get(s)))return!1;break;case Object:if(l(t)!==l(e))return!1;for(const s in t)if(!g(t,s)||!y(t[s],e[s]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!y(t[s],e[s]))return!1;break;default:return!1}return!0};var p=s(3559);class m extends u{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const t=o();null!==this.getLocalState()&&15e3<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const e=[];this.meta.forEach(((s,n)=>{n!==this.clientID&&3e4<=t-s.lastUpdated&&this.states.has(n)&&e.push(n)})),e.length>0&&_(this,e,"timeout")}),r(3e3)),t.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID,s=this.meta.get(e),n=void 0===s?0:s.clock+1,a=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:n,lastUpdated:o()});const r=[],i=[],h=[],c=[];null===t?c.push(e):null==a?null!=t&&r.push(e):(i.push(e),y(a,t)||h.push(e)),(r.length>0||h.length>0||c.length>0)&&this.emit("change",[{added:r,updated:h,removed:c},"local"]),this.emit("update",[{added:r,updated:i,removed:c},"local"])}setLocalStateField(t,e){const s=this.getLocalState();null!==s&&this.setLocalState({...s,[t]:e})}getStates(){return this.states}}const _=(t,e,s)=>{const n=[];for(let s=0;s<e.length;s++){const a=e[s];if(t.states.has(a)){if(t.states.delete(a),a===t.clientID){const e=t.meta.get(a);t.meta.set(a,{clock:e.clock+1,lastUpdated:o()})}n.push(a)}}n.length>0&&(t.emit("change",[{added:[],updated:[],removed:n},s]),t.emit("update",[{added:[],updated:[],removed:n},s]))},M=t=>JSON.parse(JSON.stringify(t));class v{constructor(){this.isDisposed=!1,this.ydoc=new p.Doc,this.source=this.ydoc.getText("source"),this.ystate=this.ydoc.getMap("state"),this.undoManager=new p.UndoManager([this.source],{trackedOrigins:new Set([this])}),this.awareness=new m(this.ydoc),this._changed=new a.Signal(this)}get dirty(){return this.ystate.get("dirty")}set dirty(t){this.transact((()=>{this.ystate.set("dirty",t)}),!1)}transact(t,e=!0){this.ydoc.transact(t,e?this:null)}dispose(){this.isDisposed=!0,this.ydoc.destroy()}canUndo(){return this.undoManager.undoStack.length>0}canRedo(){return this.undoManager.redoStack.length>0}undo(){this.undoManager.undo()}redo(){this.undoManager.redo()}clearUndoHistory(){this.undoManager.clear()}get changed(){return this._changed}}class w{constructor(t){this._notebook=null,this.isStandalone=!1,this._modelObserver=t=>{const e={},s=t.find((t=>t.target===this.ymodel.get("source")));s&&(e.sourceChange=s.changes.delta);const n=t.find((t=>t.target===this.ymodel.get("outputs")));n&&(e.outputsChange=n.changes.delta);const a=t.find((t=>t.target===this.ymodel));if(a&&a.keysChanged.has("metadata")){const t=a.changes.keys.get("metadata");e.metadataChange={oldValue:(null==t?void 0:t.oldValue)?t.oldValue:void 0,newValue:this.getMetadata()}}if(a&&a.keysChanged.has("execution_count")){const t=a.changes.keys.get("execution_count");e.executionCountChange={oldValue:t.oldValue,newValue:this.ymodel.get("execution_count")}}const o=this.ymodel.get("source");a&&a.keysChanged.has("source")&&(e.sourceChange=[{delete:this._prevSourceLength},{insert:o.toString()}]),this._prevSourceLength=o.length,this._changed.emit(e)},this.isDisposed=!1,this._undoManager=null,this._changed=new a.Signal(this),this.ymodel=t;const e=t.get("source");this._prevSourceLength=e?e.length:0,this.ymodel.observeDeep(this._modelObserver),this._awareness=null}get ysource(){return this.ymodel.get("source")}get awareness(){var t,e,s;return null!==(s=null!==(t=this._awareness)&&void 0!==t?t:null===(e=this.notebook)||void 0===e?void 0:e.awareness)&&void 0!==s?s:null}transact(t,e=!0){this.notebook&&e?this.notebook.transact(t):this.ymodel.doc.transact(t,this)}get undoManager(){var t;return this.notebook?(null===(t=this.notebook)||void 0===t?void 0:t.disableDocumentWideUndoRedo)?this._undoManager:this.notebook.undoManager:this._undoManager}set undoManager(t){this._undoManager=t}undo(){var t;null===(t=this.undoManager)||void 0===t||t.undo()}redo(){var t;null===(t=this.undoManager)||void 0===t||t.redo()}canUndo(){return!!this.undoManager&&this.undoManager.undoStack.length>0}canRedo(){return!!this.undoManager&&this.undoManager.redoStack.length>0}clearUndoHistory(){var t;null===(t=this.undoManager)||void 0===t||t.clear()}get notebook(){return this._notebook}static create(t=n.UUID.uuid4()){const e=new p.Map,s=new p.Text;return e.set("source",s),e.set("metadata",{}),e.set("cell_type",this.prototype.cell_type),e.set("id",t),new this(e)}static createStandalone(t){const e=this.create(t);e.isStandalone=!0;const s=new p.Doc;return s.getArray().insert(0,[e.ymodel]),e._awareness=new m(s),e._undoManager=new p.UndoManager([e.ymodel],{trackedOrigins:new Set([e])}),e}clone(){const t=new p.Map,e=new p.Text(this.getSource());t.set("source",e),t.set("metadata",this.getMetadata()),t.set("cell_type",this.cell_type),t.set("id",this.getId());const s=new(0,this.constructor)(t);return s._undoManager=this.undoManager,s}get changed(){return this._changed}dispose(){this.ymodel.unobserveDeep(this._modelObserver),this._awareness&&this._awareness.destroy(),!this.notebook&&this._undoManager&&this._undoManager.destroy()}getAttachments(){return this.ymodel.get("attachments")}setAttachments(t){this.transact((()=>{null==t?this.ymodel.delete("attachments"):this.ymodel.set("attachments",t)}))}getId(){return this.ymodel.get("id")}getSource(){return this.ymodel.get("source").toString()}setSource(t){const e=this.ymodel.get("source");this.transact((()=>{e.delete(0,e.length),e.insert(0,t)}))}updateSource(t,e,s=""){this.transact((()=>{const n=this.ysource;n.insert(t,s),n.delete(t+s.length,e-t)}))}get cell_type(){throw new Error("A YBaseCell must not be constructed")}getMetadata(){return M(this.ymodel.get("metadata"))}setMetadata(t){this.transact((()=>{this.ymodel.set("metadata",M(t))}))}toJSON(){return{id:this.getId(),cell_type:this.cell_type,source:this.getSource(),metadata:this.getMetadata()}}}class f extends w{get cell_type(){return"code"}get execution_count(){return this.ymodel.get("execution_count")}set execution_count(t){this.transact((()=>{this.ymodel.set("execution_count",t)}))}getOutputs(){return M(this.ymodel.get("outputs").toArray())}setOutputs(t){const e=this.ymodel.get("outputs");this.transact((()=>{e.delete(0,e.length),e.insert(0,t)}),!1)}updateOutputs(t,e,s=[]){const n=this.ymodel.get("outputs"),a=e<n.length?e-t:n.length-t;this.transact((()=>{n.delete(t,a),n.insert(t,s)}),!1)}static create(t){const e=super.create(t);return e.ymodel.set("execution_count",0),e.ymodel.set("outputs",new p.Array),e}static createStandalone(t){const e=super.createStandalone(t);return e.ymodel.set("execution_count",null),e.ymodel.set("outputs",new p.Array),e}clone(){const t=super.clone(),e=new p.Array;return e.insert(0,this.getOutputs()),t.ymodel.set("execution_count",this.execution_count),t.ymodel.set("outputs",e),t}toJSON(){return{id:this.getId(),cell_type:"code",source:this.getSource(),metadata:this.getMetadata(),outputs:this.getOutputs(),execution_count:this.execution_count}}}}}]);