build:
    context: {{ aux.docker.project_dir }}
    dockerfile: devops/docker/{{ opts.full_name }}.dockerfile
    cache_from:
    - {{ opts.full_name }}
    {%- if opts.get("pip_cred_vars",[]) | length or opts.get("base_match",[]) or set_args %}
    args:
        {% for cred in opts.get("pip_cred_vars",[]) -%}
            {{ cred }}: ${{ cred }}
        {% endfor -%}
        {% for match in opts.get("base_match",[]) -%}
            {{ match[1] }}: ${{ match[1] }}
        {% endfor -%}
    {%- endif %}
