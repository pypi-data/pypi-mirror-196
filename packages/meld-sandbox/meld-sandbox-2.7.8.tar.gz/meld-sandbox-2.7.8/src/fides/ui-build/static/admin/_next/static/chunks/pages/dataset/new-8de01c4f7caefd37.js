(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8538],{58144:function(e,t,r){"use strict";var n=r(59499),a=r(26537),s=r(23256),i=r(43894),o=r(85893);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.Z=function(e){var t=e.isOpen,r=e.onClose,n=e.onConfirm,c=e.title,l=e.message,d=e.cancelButtonText,f=e.cancelButtonThemingProps,p=e.continueButtonText,h=e.continueButtonThemingProps,m=e.isLoading,y=e.returnFocusOnClose,b=e.isCentered;return(0,o.jsxs)(a.u_,{isOpen:t,onClose:r,size:"lg",returnFocusOnClose:null===y||void 0===y||y,isCentered:b,children:[(0,o.jsx)(a.ZA,{}),(0,o.jsxs)(a.hz,{textAlign:"center",p:2,"data-testid":"confirmation-modal",children:[c?(0,o.jsx)(a.xB,{fontWeight:"medium",children:c}):null,l?(0,o.jsx)(a.fe,{children:l}):null,(0,o.jsx)(a.mz,{children:(0,o.jsxs)(s.MI,{columns:2,width:"100%",children:[(0,o.jsx)(i.zx,u(u({variant:"outline",mr:3,onClick:r,"data-testid":"cancel-btn",isDisabled:m},f),{},{children:d||"Cancel"})),(0,o.jsx)(i.zx,u(u({colorScheme:"primary",onClick:n,"data-testid":"continue-btn",isLoading:m},h),{},{children:p||"Continue"}))]})})]})]})}},10846:function(e,t,r){"use strict";r.d(t,{V:function(){return f},t:function(){return d}});var n=r(59499),a=r(23256),s=r(85893);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=function(e){var t=e.message;return(0,s.jsxs)(a.xv,{"data-testid":"toast-success-msg",children:[(0,s.jsx)("strong",{children:"Success:"})," ",t]})},u=function(e){var t=e.message;return(0,s.jsxs)(a.xv,{"data-testid":"toast-error-msg",children:[(0,s.jsx)("strong",{children:"Error:"})," ",t]})},l={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},d=function(e){var t=(0,s.jsx)(c,{message:e});return o(o({},l),{description:t})},f=function(e){var t=(0,s.jsx)(u,{message:e});return o(o({},l),{description:t,status:"error"})}},31748:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n=r(23256),a=r(20440),s=r(43894),i=r(41664),o=r.n(i),c=r(67294),u=r(17140),l=r(59499),d=r(50029),f=r(16835),p=r(87794),h=r.n(p),m=r(13450),y=r(82175),b=r(11163),x=r(14416),g=r(74231),j=r(58144),v=r(53700),O=r(96016),w=r(65698),C=r(10846),k=r(70889),P=r(41438),_=r(68045),S=r(29112),D=r(85893);function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){(0,l.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){return!("system_type"in e)},E={url:"",classify:!1,classifyConfirmed:!1},L=g.Ry().shape({url:g.Z_().required().label("Database URL"),classify:g.O7(),classifyConfirmed:g.O7().when(["url","classify"],{is:function(e,t){return e&&t},then:g.O7().equals([!0])})}),T=function(){var e=(0,S.pR)(),t=(0,f.Z)(e,2),r=t[0],a=t[1].isLoading,i=(0,S.IR)(),o=(0,f.Z)(i,2),c=o[0],u=o[1].isLoading,l=(0,P.Du)(),p=(0,f.Z)(l,2),g=p[0],Z=p[1].isLoading,T=a||u||Z,B=(0,m.pm)(),R=(0,b.useRouter)(),Y=(0,v.hz)(),F=(0,x.useDispatch)(),M=function(){var e=(0,d.Z)(h().mark((function e(t){var n,a,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({organization_key:k.Av,generate:{config:{connection_string:t.url},target:_.GC.DB,type:_.j.DATASETS}});case 2:if(!("error"in(a=e.sent))){e.next=5;break}return e.abrupt("return",{error:(0,w.e$)(a.error)});case 5:if((s=(null!==(n=a.data.generate_results)&&void 0!==n?n:[]).filter(A))&&s.length>0){e.next=8;break}return e.abrupt("return",{error:"Unable to generate a dataset with this connection."});case 8:return e.abrupt("return",{datasets:s});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,d.Z)(h().mark((function e(t){var r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t);case 2:if(!("error"in(r=e.sent))){e.next=5;break}return e.abrupt("return",{error:(0,w.e$)(r.error)});case 5:return e.abrupt("return",{dataset:r.data});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=(0,d.Z)(h().mark((function e(t){var r,n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.values,n=t.datasets,e.next=3,g({dataset_schemas:n.map((function(e){var t=e.name;return{fides_key:e.fides_key,name:t}})),schema_config:{organization_key:k.Av,generate:{config:{connection_string:r.url},target:_.GC.DB,type:_.j.DATASETS}}});case 3:if(!("error"in(a=e.sent))){e.next=6;break}return e.abrupt("return",{error:(0,w.e$)(a.error)});case 6:return e.abrupt("return",{classifyInstances:a.data.classify_instances});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,d.Z)(h().mark((function e(t){var r,n,a,s,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t);case 2:if(!("error"in(n=e.sent))){e.next=6;break}return B((0,C.V)(n.error)),e.abrupt("return");case 6:return e.next=8,Promise.all(n.datasets.map((function(e){return G(e)})));case 8:if(a=e.sent,!("error"in(s=null!==(r=a.find((function(e){return"error"in e})))&&void 0!==r?r:a[0]))){e.next=13;break}return B((0,C.V)(s.error)),e.abrupt("return");case 13:if(t.classify){e.next=17;break}return B((0,C.t)("Generated ".concat(s.dataset.name," dataset"))),R.push("/dataset/".concat(s.dataset.fides_key)),e.abrupt("return");case 17:return e.next=19,N({values:t,datasets:n.datasets});case 19:if(!("error"in(i=e.sent))){e.next=23;break}return B((0,C.V)(i.error)),e.abrupt("return");case 23:B((0,C.t)("Generate and classify are now in progress")),F((0,S.Zl)(s.dataset.fides_key)),R.push("/dataset");case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,D.jsx)(y.J9,{initialValues:z(z({},E),{},{classify:Y.plus}),validationSchema:L,onSubmit:U,validateOnChange:!1,validateOnBlur:!1,children:function(e){var t=e.isSubmitting,r=e.errors,a=e.values,i=e.submitForm,o=e.resetForm,c=e.setFieldValue;return(0,D.jsxs)(y.l0,{children:[(0,D.jsxs)(n.gC,{spacing:8,align:"left",children:[(0,D.jsx)(n.xv,{size:"sm",color:"gray.700",children:"Connect to a database using the connection URL. You may have received this URL from a colleague or your Ethyca developer support engineer."}),(0,D.jsx)(n.xu,{children:(0,D.jsx)(O.j0,{name:"url",label:"Database URL"})}),Y.plus?(0,D.jsx)(O.w8,{name:"classify",label:"Classify dataset",tooltip:"Use Fides Classify to suggest labels based on your data."}):null,(0,D.jsx)(n.xu,{children:(0,D.jsx)(s.zx,{size:"sm",colorScheme:"primary",type:"submit",isLoading:t||T,isDisabled:t||T,"data-testid":"create-dataset-btn",children:"Generate dataset"})})]}),(0,D.jsx)(j.Z,{title:"Generate and classify this dataset",message:"You have chosen to generate and classify this dataset. This process may take several minutes. In the meantime you can continue using Fides. You will receive a notification when the process is complete.",isOpen:void 0!==r.classifyConfirmed,onClose:function(){o({values:z(z({},a),{},{classifyConfirmed:!1})})},onConfirm:function(){c("classifyConfirmed",!0),setTimeout((function(){i()}),0)}})]})}})},B=r(1272),R={yaml:""},Y=function(e){var t=e.description,r=e.submitButtonText,a=e.onCreate,i=e.onSuccess,o=function(){var e=(0,d.Z)(h().mark((function e(t,r){var n,s,o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.setErrors,s=B.ZP.load(t.yaml,{json:!0}),e.next=4,a(s);case 4:"error"in(o=e.sent)?(c=(0,w.e$)(o.error),n({yaml:c})):"data"in o&&i(o.data);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return(0,D.jsx)(y.J9,{initialValues:R,validate:function(e){try{if(!B.ZP.load(e.yaml,{json:!0}))return{yaml:"Could not parse the supplied YAML"}}catch(t){return(0,w.FM)(t)?{yaml:"Could not parse the supplied YAML: \n\n".concat(t.message)}:{yaml:"Could not parse the supplied YAML"}}return{}},onSubmit:o,validateOnChange:!1,validateOnBlur:!1,children:function(e){var a=e.isSubmitting;return(0,D.jsxs)(y.l0,{children:[(0,D.jsx)(n.xv,{size:"sm",color:"gray.700",mb:4,children:t}),(0,D.jsx)(n.xu,{mb:4,whiteSpace:"pre-line",fontFamily:"Menlo",children:(0,D.jsx)(O.Ks,{name:"yaml",textAreaProps:{fontWeight:400,lineHeight:"150%",color:"gray.800",fontSize:"13px",height:"50vh",width:"100%",mb:"2"}})}),(0,D.jsx)(s.zx,{size:"sm",colorScheme:"primary",type:"submit",disabled:a,"data-testid":"submit-yaml-btn",children:r})]})}})};var F=function(){var e=(0,S.IR)(),t=(0,f.Z)(e,1)[0],r=(0,m.pm)(),n=(0,b.useRouter)(),a=function(){var e=(0,d.Z)(h().mark((function e(r){var n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"object"===typeof(s=r)&&null!=s&&"dataset"in s&&Array.isArray(s.dataset)?(a=(0,f.Z)(r.dataset,1),n=a[0]):n=r,e.abrupt("return",t(n));case 2:case"end":return e.stop()}var s}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,D.jsx)(Y,{description:"Get started creating your first dataset by pasting your dataset yaml below! You may have received this yaml from a colleague or your Ethyca developer support engineer.",submitButtonText:"Create dataset",onCreate:a,onSuccess:function(e){r((0,C.t)("Successfully loaded new dataset YAML")),(0,S.Zl)(e.fides_key),n.push("/dataset/".concat(e.fides_key))}})},M=function(){var e=(0,c.useState)(null),t=e[0],r=e[1];return(0,D.jsxs)(u.Z,{title:"Datasets",children:[(0,D.jsx)(n.X6,{mb:2,fontSize:"2xl",fontWeight:"semibold",children:"Datasets"}),(0,D.jsx)(n.xu,{mb:8,children:(0,D.jsxs)(a.aG,{fontWeight:"medium",fontSize:"sm",color:"gray.600",children:[(0,D.jsx)(a.gN,{children:(0,D.jsx)(o(),{href:"/dataset",children:"Datasets"})}),(0,D.jsx)(a.gN,{children:(0,D.jsx)(o(),{href:"#",children:"Create new dataset"})})]})}),(0,D.jsxs)(n.Kq,{spacing:8,children:[(0,D.jsx)(n.xu,{w:{base:"100%",lg:"50%"},children:(0,D.jsx)(n.xv,{children:"Create a dataset using YAML or connect to a database."})}),(0,D.jsxs)(n.xu,{children:[(0,D.jsx)(s.zx,{size:"sm",mr:2,variant:"outline",onClick:function(){return r("yaml")},isActive:"yaml"===t,"data-testid":"upload-yaml-btn",children:"Upload a new dataset YAML"}),(0,D.jsx)(s.zx,{size:"sm",mr:2,variant:"outline",onClick:function(){return r("database")},isActive:"database"===t,"data-testid":"connect-db-btn",children:"Connect to a database"})]}),(0,D.jsxs)(n.xu,{w:{base:"100%",lg:"50%"},children:["yaml"===t?(0,D.jsx)(F,{}):null,"database"===t?(0,D.jsx)(T,{}):null]})]})]})}},52569:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dataset/new",function(){return r(31748)}])}},function(e){e.O(0,[5372,7601,248,2350,6648,4231,440,1272,7140,7080,9774,2888,179],(function(){return t=52569,e(e.s=t);var t}));var t=e.O();_N_E=t}]);