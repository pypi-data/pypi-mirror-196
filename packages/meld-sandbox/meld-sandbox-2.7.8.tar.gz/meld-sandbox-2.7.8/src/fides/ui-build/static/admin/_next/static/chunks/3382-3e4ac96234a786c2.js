"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3382],{70783:function(e,r,s){s.d(r,{HK:function(){return a},VY:function(){return n.V}});var n=s(63719),t=s(65698),a=function(){var e=(0,n.V)().errorAlert;return{handleError:function(r){var s="An unexpected error occurred. Please try again.";(0,t.Ot)(r)?s=r.data.detail:(0,t.tB)(r)&&(s=r.data.detail[0].msg),e(s)}}};s(67294)},63719:function(e,r,s){s.d(r,{V:function(){return u}});var n=s(59499),t=s(13450),a=s(26707),i=s(23256),o=s(93225),c=s(85893);function l(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,n)}return s}function d(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?l(Object(s),!0).forEach((function(r){(0,n.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var u=function(){var e=(0,t.pm)();return{errorAlert:function(r,s,n){var t=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(a.bZ,{alignItems:"normal",status:"error",children:[(0,c.jsx)(a.zM,{}),(0,c.jsxs)(i.xu,{children:[s&&(0,c.jsx)(a.Cd,{children:s}),(0,c.jsx)(a.X,{children:r})]}),(0,c.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,t):e(t)},successAlert:function(r,s,n){var t=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(a.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,c.jsx)(a.zM,{}),(0,c.jsxs)(i.xu,{children:[s&&(0,c.jsx)(a.Cd,{children:s}),(0,c.jsx)(a.X,{children:r})]}),(0,c.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,t):e(t)}}}},10846:function(e,r,s){s.d(r,{V:function(){return p},t:function(){return u}});var n=s(59499),t=s(23256),a=s(85893);function i(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,n)}return s}function o(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?i(Object(s),!0).forEach((function(r){(0,n.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var c=function(e){var r=e.message;return(0,a.jsxs)(t.xv,{"data-testid":"toast-success-msg",children:[(0,a.jsx)("strong",{children:"Success:"})," ",r]})},l=function(e){var r=e.message;return(0,a.jsxs)(t.xv,{"data-testid":"toast-error-msg",children:[(0,a.jsx)("strong",{children:"Error:"})," ",r]})},d={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},u=function(e){var r=(0,a.jsx)(c,{message:e});return o(o({},d),{description:r})},p=function(e){var r=(0,a.jsx)(l,{message:e});return o(o({},d),{description:r,status:"error"})}},53547:function(e,r,s){s.d(r,{Z:function(){return B}});var n=s(27812),t=s(50029),a=s(16835),i=s(87794),o=s.n(i),c=s(23256),l=s(43894),d=s(12036),u=s(70783),p=s(82175),h=s(41664),m=s.n(h),f=s(11163),j=s(67294),x=s(14416),w=s(74231),b=s(18459),v=s(96016),g=w.Z_().required().min(8,"Password must have at least eight characters.").matches(/[0-9]/,"Password must have at least one number.").matches(/[A-Z]/,"Password must have at least one capital letter.").matches(/[a-z]/,"Password must have at least one lowercase letter.").matches(/[\W]/,"Password must have at least one symbol."),y=s(37161),O=s(97142),P=s(59499),C=s(97375),z=s(13450),_=s(26537),S=s(65698),k=s(10846),Z=s(26595),E=s(43072),D=s(85893);function V(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,n)}return s}function q(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?V(Object(s),!0).forEach((function(r){(0,P.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var A=w.Ry().shape({password:g.label("Password"),passwordConfirmation:w.Z_().required().oneOf([w.iH("password")],"Passwords must match").label("Password confirmation")}),R={password:"",passwordConfirmation:""},I=function(e){var r=function(e){var r=(0,C.qY)(),s=(0,z.pm)(),n=(0,E.ls)(),i=(0,a.Z)(n,1)[0],c=function(){var n=(0,t.Z)(o().mark((function n(t){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i({id:e,new_password:t.password});case 2:a=n.sent,(0,Z.isErrorResult)(a)?s((0,k.V)((0,S.e$)(a.error))):(s((0,k.t)("Successfully reset user's password. Please inform the user of their new password.")),r.onClose());case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return q(q({},r),{},{handleResetPassword:c})}(e.id),s=r.handleResetPassword,n=r.isOpen,i=r.onClose,d=r.onOpen;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(l.zx,{colorScheme:"primary",size:"sm",onClick:d,"data-testid":"reset-password-btn",children:"Reset password"}),(0,D.jsxs)(_.u_,{isCentered:!0,isOpen:n,onClose:i,children:[(0,D.jsx)(_.ZA,{}),(0,D.jsx)(_.hz,{children:(0,D.jsx)(p.J9,{initialValues:R,validationSchema:A,onSubmit:s,children:function(e){var r=e.isSubmitting,s=e.dirty,n=e.isValid;return(0,D.jsxs)(p.l0,{children:[(0,D.jsx)(_.xB,{children:"Reset Password"}),(0,D.jsx)(_.ol,{}),(0,D.jsx)(_.fe,{children:(0,D.jsxs)(c.Kq,{direction:"column",spacing:4,children:[(0,D.jsx)(c.xv,{mb:2,children:"Choose a new password for this user."}),(0,D.jsx)(v.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}),(0,D.jsx)(v.j0,{name:"passwordConfirmation",label:"Confirm Password",placeholder:"********",type:"password",tooltip:"Must match above password."})]})}),(0,D.jsx)(_.mz,{children:(0,D.jsxs)(l.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,D.jsx)(l.zx,{onClick:i,variant:"outline",width:"50%",children:"Cancel"}),(0,D.jsx)(l.zx,{colorScheme:"primary",disabled:!s||!n,isLoading:r,type:"submit",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})})]})}})})]})]})},N=s(27634),M=s(30268);function U(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,n)}return s}function F(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?U(Object(s),!0).forEach((function(r){(0,P.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):U(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var K=function(e){var r=function(e){var r=(0,C.qY)(),s=(0,j.useState)(""),n=s[0],i=s[1],c=(0,j.useState)(""),l=c[0],d=c[1],u=(0,E.ev)(),p=(0,a.Z)(u,2),h=p[0],m=p[1].isLoading,f=!!(e&&l&&n),x=function(){var s=(0,t.Z)(o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:f&&h({id:e,old_password:n,new_password:l}).unwrap().then((function(){return r.onClose()}));case 1:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();return F(F({},r),{},{changePasswordValidation:f,handleChange:function(e){"oldPassword"===e.target.name?i(e.target.value):d(e.target.value)},handleChangePassword:x,isLoading:m,newPasswordValue:l,oldPasswordValue:n})}(e.id),s=r.changePasswordValidation,n=r.handleChange,i=r.handleChangePassword,d=r.isLoading,u=r.isOpen,p=r.newPasswordValue,h=r.oldPasswordValue,m=r.onClose,f=r.onOpen;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(l.zx,{colorScheme:"primary",size:"sm",onClick:f,"data-testid":"update-password-btn",children:"Update Password"}),(0,D.jsxs)(_.u_,{isCentered:!0,isOpen:u,onClose:m,children:[(0,D.jsx)(_.ZA,{}),(0,D.jsxs)(_.hz,{children:[(0,D.jsx)(_.xB,{children:"Update Password"}),(0,D.jsx)(_.ol,{}),(0,D.jsx)(_.fe,{pb:6,children:(0,D.jsxs)(c.Kq,{direction:"column",spacing:"15px",children:[(0,D.jsx)(N.NI,{children:(0,D.jsx)(M.II,{isRequired:!0,name:"oldPassword",onChange:n,placeholder:"Old Password",type:"password",value:h,"data-testid":"input-oldPassword"})}),(0,D.jsx)(N.NI,{children:(0,D.jsx)(M.II,{isRequired:!0,name:"newPassword",onChange:n,placeholder:"New Password",type:"password",value:p,"data-testid":"input-newPassword"})})]})}),(0,D.jsxs)(_.mz,{children:[(0,D.jsx)(l.zx,{bg:"white",marginRight:"10px",onClick:m,size:"sm",variant:"solid",width:"50%",children:"Cancel"}),(0,D.jsx)(l.zx,{bg:"primary.800",color:"white",disabled:!s,isLoading:d,mr:3,onClick:i,size:"sm",type:"submit",variant:"solid",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})]})]})]})},L=function(e){var r,s=e.profileId,n=null==s,t=(0,O.C)(y.dy),a=(0,E.gU)(null!==(r=null===t||void 0===t?void 0:t.id)&&void 0!==r?r:"").data,i=!!t&&t.id===s,o=!!a&&a.scopes.includes("user:password-reset");return n?(0,D.jsx)(v.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}):s&&(i||o)?(0,D.jsxs)(c.Ug,{children:[i?(0,D.jsx)(K,{id:s}):null,o?(0,D.jsx)(I,{id:s}):null]}):null},X="privacy-request:read",H={organization_fides_key:"",username:"",first_name:"",last_name:"",password:"",scopes:[X]},W=w.Ry().shape({organization_fides_key:w.Z_().required().label("Organization"),username:w.Z_().required().label("Username"),first_name:w.Z_().label("First name"),last_name:w.Z_().label("Last name"),password:g.label("Password"),scopes:w.IX().of(w.Z_())}),B=function(e){var r=e.onSubmit,s=e.initialValues,i=e.canEditNames,h=e.canChangePassword,w=(0,f.useRouter)(),g=(0,u.HK)().handleError,O=Array.isArray(w.query.id)?w.query.id[0]:w.query.id,P=!(null==O)&&!i,C=(0,E.lD)(),z=(0,a.Z)(C,1)[0],_=(0,x.useSelector)(y.mT).organization_fides_key;H={organization_fides_key:_,username:"",first_name:"",last_name:"",password:"",scopes:[X]};var S=function(){var e=(0,t.Z)(o().mark((function e(s){var t,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(s);case 2:if(!("error"in(t=e.sent))){e.next=6;break}return g(t.error),e.abrupt("return");case 6:return a=t.data,i={user_id:a.id,scopes:(0,n.Z)(new Set([].concat((0,n.Z)(s.scopes),[X])))},e.next=10,z(i);case 10:"error"in e.sent||w.push(b.e3);case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),k=h?W:W.omit(["password"]),Z=(0,j.useMemo)((function(){return b.GM.map((function(e){return e.scope}))}),[]),V=(0,j.useCallback)((function(e){e.setFieldValue("scopes",(0,n.Z)(Z))}),[Z]),q=(0,j.useCallback)((function(e){e.setFieldValue("scopes",[X])}),[]);return(0,D.jsx)(p.J9,{onSubmit:S,initialValues:null!==s&&void 0!==s?s:H,validationSchema:k,children:function(e){return(0,D.jsx)(p.l0,{children:(0,D.jsxs)(c.xu,{maxW:["xs","xs","100%"],width:"100%",children:[(0,D.jsxs)(c.Kq,{mb:8,spacing:6,children:[(0,D.jsxs)(c.Kq,{mb:8,spacing:6,maxWidth:"70%",children:[(0,D.jsx)(v.j0,{name:"organization_fides_key",label:"Organization",disabled:!0}),(0,D.jsx)(v.j0,{name:"username",label:"Username",placeholder:"Enter new username"}),(0,D.jsx)(v.j0,{name:"first_name",label:"First Name",placeholder:"Enter first name of user",disabled:P}),(0,D.jsx)(v.j0,{name:"last_name",label:"Last Name",placeholder:"Enter last name of user",disabled:P}),(0,D.jsx)(L,{profileId:O})]}),(0,D.jsx)(c.iz,{mb:7,mt:7}),(0,D.jsx)(c.X6,{fontSize:"xl",colorScheme:"primary",children:"Permissions"}),(0,D.jsx)(c.xv,{children:"Select permissions to assign to this user"}),(0,D.jsxs)(c.xu,{children:[(0,D.jsx)(l.zx,{variant:"outline",size:"sm",mr:3,onClick:function(){V(e)},children:"Select all"}),(0,D.jsx)(l.zx,{variant:"outline",size:"sm",onClick:function(){q(e)},children:"Deselect all"})]}),(0,D.jsx)(c.xv,{children:"To apply the changes, click 'Save' below."}),(0,D.jsx)(c.iz,{mb:2,mt:2}),(0,D.jsx)(c.Kq,{spacing:[1,5],direction:"column",children:b.GM.map((function(r){var s=e.values.scopes.indexOf(r.scope)>=0;return(0,D.jsx)(d.XZ,{colorScheme:"purple",onChange:function(){s?e.setFieldValue("scopes",e.values.scopes.filter((function(e){return e!==r.scope}))):e.setFieldValue("scopes",[].concat((0,n.Z)(e.values.scopes),[r.scope]))},id:"scopes-".concat(r.privilege),name:"scopes",isChecked:s,value:r.scope===X?void 0:r.scope,isDisabled:r.scope===X,isReadOnly:r.scope===X,children:r.privilege},r.privilege)}))})]}),(0,D.jsx)(m(),{href:b.e3,passHref:!0,children:(0,D.jsx)(l.zx,{variant:"outline",mr:3,size:"sm",children:"Cancel"})}),(0,D.jsx)(l.zx,{type:"submit",bg:"primary.800",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},colorScheme:"primary",size:"sm",children:"Save"})]})})}})}},33278:function(e,r,s){var n=s(23256),t=s(20440),a=s(41664),i=s.n(a),o=(s(67294),s(17140)),c=s(18459),l=s(85893);r.Z=function(e){var r=e.title,s=e.children;return(0,l.jsxs)(o.Z,{title:"User Management",children:[(0,l.jsxs)(n.X6,{fontSize:"2xl",fontWeight:"semibold",children:["User Management",(0,l.jsx)(n.xu,{mt:2,mb:7,children:(0,l.jsxs)(t.aG,{fontWeight:"medium",fontSize:"sm",children:[(0,l.jsx)(t.gN,{children:(0,l.jsx)(i(),{href:c.e3,passHref:!0,children:(0,l.jsx)(t.At,{href:c.e3,children:"User Management"})})}),(0,l.jsx)(t.gN,{children:(0,l.jsx)(t.At,{href:"#",children:r})})]})})]}),s]})}},26595:function(e,r,s){s.d(r,{isAPIError:function(){return n.Bw},isErrorResult:function(){return n.D4}});var n=s(27396)}}]);