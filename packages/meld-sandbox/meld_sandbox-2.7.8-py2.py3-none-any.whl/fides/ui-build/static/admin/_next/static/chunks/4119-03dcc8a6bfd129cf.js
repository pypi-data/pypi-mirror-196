"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4119],{68293:function(e,n,t){var r=t(23256),s=t(43894),i=t(85893);n.Z=function(e){var n=e.page,t=e.size,a=e.total,o=e.handleNextPage,l=e.handlePreviousPage,c=(n-1)*t+1,u=Math.min(a,n*t);return(0,i.jsxs)(r.kC,{justifyContent:"space-between",mt:6,children:[(0,i.jsx)(r.xv,{fontSize:"xs",color:"gray.600",children:a>0?(0,i.jsxs)(i.Fragment,{children:["Showing ",Number.isNaN(c)?0:c," to"," ",Number.isNaN(u)?0:u," of"," ",Number.isNaN(a)?0:a," results"]}):"0 results"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(s.zx,{disabled:n<=1,onClick:l,mr:2,size:"sm",children:"Previous"}),(0,i.jsx)(s.zx,{disabled:n*t>=a,onClick:o,size:"sm",children:"Next"})]})]})}},44068:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(16835),s=t(27812),i=t(23256),a=t(37991),o=t(77601),l=t(43894),c=t(48591),u=t(67294),d=t(12036),h=t(85893),x=function(e){var n=e.defaultValues,t=e.items,o=e.onSelection,c=(0,u.useState)(t),x=c[0],f=c[1];return(0,h.jsxs)(a.qy,{lineHeight:"1rem",p:"0",children:[(0,h.jsxs)(i.kC,{borderBottom:"1px",borderColor:"gray.200",cursor:"auto",p:"8px",children:[(0,h.jsx)(l.zx,{onClick:function(){f(t),o(new Map)},size:"xs",variant:"outline",children:"Clear"}),(0,h.jsx)(i.LZ,{}),(0,h.jsx)(l.zx,{backgroundColor:"primary.800",color:"white",onClick:function(){o(x)},size:"xs",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},children:"Done"})]}),(0,h.jsx)(i.xu,{maxH:"360px",overflow:"auto",children:(0,h.jsx)(d.cO,{colorScheme:"purple",defaultValue:n,onChange:function(e){var n=new Map(x);n.forEach((function(e,t){n.set(t,!1)})),e.forEach((function(e){n.set(e,!0)})),f(n)},children:(0,s.Z)(t).sort().map((function(e){var n=(0,r.Z)(e,1)[0];return(0,h.jsx)(a.sN,{paddingTop:"10px",paddingRight:"8.5px",paddingBottom:"10px",paddingLeft:"8.5px",_focus:{bg:"gray.100"},children:(0,h.jsx)(d.XZ,{"aria-label":n,isChecked:t.get(n),spacing:".5rem",value:n,width:"100%",children:(0,h.jsx)(i.xv,{fontSize:"0.75rem",children:n})})},n)}))})})]})},f=function(e){var n=e.closeOnSelect,t=void 0!==n&&n,d=e.list,f=e.onChange,p=e.selectedList,v=e.label,j=e.tooltipDisabled,g=void 0!==j&&j,m=e.tooltipPlacement,C=void 0===m?"auto":m,b=e.width,y=new Map(d),S=(0,u.useState)(!1),k=S[0],w=S[1],E=function(){w(!1)},I=function(){return g?v:p.size>0?(0,s.Z)(p.keys()).sort().join(", "):v};return(0,h.jsx)(i.xu,{children:(0,h.jsxs)(a.v2,{closeOnSelect:t,isLazy:!0,onClose:E,onOpen:function(){w(!0)},strategy:"fixed",children:[(0,h.jsx)(o.u,{fontSize:".75rem",hasArrow:!0,"aria-label":"",label:I(),lineHeight:"1.25rem",isDisabled:g||!(p.size>0),placement:C,children:(0,h.jsxs)(a.j2,{"aria-label":I(),as:l.zx,fontWeight:"normal",rightIcon:(0,h.jsx)(c.mC,{}),size:"sm",variant:"outline",_active:{bg:"none"},_hover:{bg:"none"},children:[!g&&(0,h.jsx)(i.xv,{display:"inline-block",isTruncated:!0,width:b,children:I()}),g&&(0,h.jsxs)(i.Ug,{children:[(0,h.jsx)(i.xv,{children:I()}),p.size>0&&(0,h.jsx)(i.xv,{color:"complimentary.500",children:p.size})]})]})}),k?(0,h.jsx)(x,{defaultValues:(0,s.Z)(p.keys()),items:y,onSelection:function(e){var n=new Map((0,s.Z)(e).filter((function(e){return!0===(0,r.Z)(e,2)[1]})));f((0,s.Z)(n.keys())),E()}}):null]})})}},84119:function(e,n,t){t.d(n,{Z:function(){return J}});var r=t(23256),s=t(5152),i=t.n(s),a=t(67294),o=t(70783),l=t(70918),c=t(85893),u=t(16835),d=t(27812),h=t(59499),x=t(50029),f=t(87794),p=t.n(f),v=t(13450),j=t(30268),g=t(48591),m=t(43894),C=t(44068),b=t(26012),y=t(14416),S=t(37161),k=new Map([["Approved","approved"],["Canceled","canceled"],["Completed","complete"],["Denied","denied"],["Error","error"],["In Progress","in_processing"],["New","pending"],["Paused","paused"],["Unverified","identity_unverified"],["Requires input","requires_input"]]);function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){(0,h.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var I,z=function(e){var n=e.revealPII,t=e.setRevealPII,s=function(e){var n=(0,y.useSelector)(l.dp),t=(0,y.useSelector)(S.rK),r=(0,y.useDispatch)(),s=(0,v.pm)(),i=(0,a.useCallback)((function(e){var n=[];e.forEach((function(e){k.forEach((function(t,r){r===e&&n.push(t)}))})),r((0,l.CI)(n))}),[r]),o=function(){var e=(0,x.Z)(p().mark((function e(){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.py)(E(E({},n),{},{token:t}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r=e.t0 instanceof Error?e.t0.message:"Unknown error occurred";case 8:r&&s({description:"".concat(r),duration:5e3,status:"error"});case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),c=function(e){var n=new Map;return k.forEach((function(t,r){var s=!1;e.includes(t)&&(s=!0),n.set(r,s)})),n},h=(0,a.useMemo)((function(){return c(n.status||[])}),[n.status]),f=new Map((0,d.Z)(h).filter((function(e){return!0===(0,u.Z)(e,2)[1]})));return E(E({handleSearchChange:function(e){return r((0,l.Nl)(e.target.value))},handleStatusChange:i,handleFromChange:function(e){return r((0,l.su)(null===e||void 0===e?void 0:e.target.value))},handleToChange:function(e){return r((0,l.Ue)(null===e||void 0===e?void 0:e.target.value))},handleClearAllFilters:function(){e(!1),r((0,l.Mk)())},handleDownloadClick:o,loadStatusList:c},n),{},{selectedStatusList:f,statusList:h})}(t),i=s.handleSearchChange,o=s.handleStatusChange,h=s.handleFromChange,f=s.handleToChange,w=s.handleClearAllFilters,I=s.handleDownloadClick,z=s.id,T=s.from,P=s.selectedStatusList,D=s.statusList,Z=s.to;return(0,c.jsxs)(r.Kq,{direction:"row",spacing:4,mb:6,children:[(0,c.jsx)(C.Z,{label:"Select Status",list:D,selectedList:P,width:"144px",onChange:o,tooltipPlacement:"top"}),(0,c.jsxs)(j.BZ,{size:"sm",children:[(0,c.jsx)(j.Z8,{pointerEvents:"none",children:(0,c.jsx)(g.PT,{color:"gray.300",w:"17px",h:"17px"})}),(0,c.jsx)(j.II,{autoComplete:"off",autoFocus:!0,type:"search",minWidth:200,placeholder:"Search Request ID",spellCheck:!1,size:"sm",borderRadius:"md",value:z,name:"search",onChange:i})]}),(0,c.jsxs)(j.BZ,{size:"sm",children:[(0,c.jsx)(j.Ui,{borderRadius:"md",children:"From"}),(0,c.jsx)(j.II,{type:"date",name:"From",value:T,max:Z||void 0,onChange:h,borderRadius:"md"})]}),(0,c.jsxs)(j.BZ,{size:"sm",children:[(0,c.jsx)(j.Ui,{borderRadius:"md",children:"To"}),(0,c.jsx)(j.II,{type:"date",borderRadius:"md",name:"To",value:Z,min:T||void 0,onChange:f})]}),(0,c.jsxs)(r.kC,{flexShrink:0,alignItems:"center",children:[(0,c.jsx)(r.xv,{fontSize:"xs",mr:2,size:"sm",children:"Reveal PII"}),(0,c.jsx)(b.Z,{revealPII:n,onChange:t})]}),(0,c.jsx)(m.zx,{variant:"ghost",flexShrink:0,rightIcon:(0,c.jsx)(g.$I,{}),size:"sm",onClick:I,children:"Download"}),(0,c.jsx)(m.zx,{variant:"ghost",flexShrink:0,rightIcon:(0,c.jsx)(g.LG,{width:"17px"}),size:"sm",onClick:w,children:"Clear all filters"})]})},T=t(78522),P=t(12036),D=t(97142),Z=t(68293),R=t(97375),q=t(26707),L=t(37991),_=t(86589),O=t(11163),N=t(90710),M=t(53700),A=t(3357),F=t(9234),B=t(13720),U=t(10061),V=t(53782),H=t(76899),X=t(1521),W=function(e){var n=e.isChecked,t=e.onCheckChange,s=e.request,i=e.revealPII,o=function(e){var n=(0,M.hz)().flags.navV2,t=(0,v.pm)(),r=(0,a.useRef)(null),s=(0,a.useState)(!1),i=s[0],o=s[1],l=(0,a.useState)(!1),u=l[0],d=l[1],h=(0,a.useState)(!1),x=h[0],f=h[1],p=(0,R.VP)(e.id).onCopy,j=(0,O.useRouter)();return{hovered:i,focused:u,menuOpen:x,resetSharedModalStates:function(){d(!1),o(!1),f(!1)},handleMenuClose:function(){return f(!1)},handleMenuOpen:function(){return f(!0)},handleMouseEnter:function(){return o(!0)},handleMouseLeave:function(){return o(!1)},handleFocus:function(){return d(!0)},handleBlur:function(){return d(!1)},handleIdCopy:function(){p(),t({title:"Request ID copied",duration:5e3,render:function(){return(0,c.jsx)(q.bZ,{bg:"gray.600",borderRadius:"6px",display:"flex",children:(0,c.jsx)(q.Cd,{color:"white",children:"Request ID copied"})})},containerStyle:{minWidth:"0px"}})},hoverButtonRef:r,shiftFocusToHoverMenu:function(){r.current&&r.current.focus()},handleViewDetails:function(){var t="/".concat(n?"privacy-requests":"subject-request","/").concat(e.id);j.push(t)}}}(s),l=o.hovered,u=o.handleMenuOpen,d=o.handleMenuClose,h=o.handleMouseEnter,x=o.handleMouseLeave,f=o.handleIdCopy,p=o.menuOpen,j=o.hoverButtonRef,C=o.shiftFocusToHoverMenu,b=o.handleFocus,y=o.handleBlur,S=o.resetSharedModalStates,k=o.focused,w=o.handleViewDetails,E=l||p||k;return(0,c.jsxs)(T.Tr,{_hover:{bg:"gray.50"},bg:E?"gray.50":"white",onMouseEnter:h,onMouseLeave:x,height:"36px","data-testid":"privacy-request-row-".concat(s.status),children:[(0,c.jsx)(T.Td,{px:0,children:(0,c.jsx)(P.XZ,{"aria-label":"Select request",isChecked:!!n,isDisabled:"error"!==s.status,onChange:function(e){return t(s.id,e.target.checked)}})}),(0,c.jsx)(T.Td,{pl:0,py:1,children:(0,c.jsx)(F.Z,{status:s.status})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(N.Z,{daysLeft:s.days_left,includeText:!1,status:s.status})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(B.Z,{rules:s.policy.rules})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(r.xv,{fontSize:"xs",children:(0,c.jsx)(A.Z,{data:s.identity&&(s.identity.email||s.identity.phone_number)||"",revealPII:i})})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(r.xv,{fontSize:"xs",children:(0,U.p6)(s.created_at)})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(r.xv,{fontSize:"xs",children:(0,c.jsx)(A.Z,{data:s.reviewer?s.reviewer.username:"",revealPII:i})})}),(0,c.jsx)(T.Td,{py:1,children:(0,c.jsx)(r.xv,{isTruncated:!0,fontSize:"xs",maxWidth:"87px",children:s.id})}),(0,c.jsxs)(T.Td,{pr:0,py:1,textAlign:"end",position:"relative",children:[(0,c.jsx)(m.zx,{size:"xs",variant:"ghost",mr:2.5,onFocus:C,tabIndex:E?-1:0,"data-testid":"privacy-request-more-btn",children:(0,c.jsx)(g.nX,{color:"gray.700",w:18,h:18})}),(0,c.jsxs)(m.hE,{isAttached:!0,variant:"outline",position:"absolute",right:2.5,top:"50%",transform:"translate(1px, -50%)",opacity:E?1:0,pointerEvents:E?"auto":"none",onFocus:b,onBlur:y,shadow:"base",borderRadius:"md",backgroundColor:"white",children:["error"===s.status&&(0,c.jsx)(X.Z,{buttonProps:{mr:"-px",size:"xs"},handleBlur:y,subjectRequest:s}),"pending"===s.status&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(V.Z,{subjectRequest:s,onClose:S,ref:j,children:"Approve"}),(0,c.jsx)(H.Z,{subjectRequest:s,onClose:S,children:"Deny"})]}),(0,c.jsxs)(L.v2,{onOpen:u,onClose:d,children:[(0,c.jsx)(L.j2,{as:m.zx,size:"xs",bg:"white",ref:"pending"!==s.status?j:null,children:(0,c.jsx)(g.nX,{color:"gray.700",w:18,h:18})}),(0,c.jsx)(_.h_,{children:(0,c.jsxs)(L.qy,{shadow:"xl","data-testid":"privacy-request-more-menu",children:[(0,c.jsx)(L.sN,{_focus:{color:"complimentary.500",bg:"gray.100"},onClick:f,children:(0,c.jsx)(r.xv,{fontSize:"sm",children:"Copy Request ID"})}),(0,c.jsx)(L.sN,{_focus:{color:"complimentary.500",bg:"gray.100"},onClick:w,children:(0,c.jsx)(r.xv,{fontSize:"sm",children:"View Details"})})]})})]})]})]})]},s.id)};!function(e){e.ASC="asc",e.DESC="desc",e.UNSELECTED="unselected"}(I||(I={}));var K=function(e){var n=e.sortField,t=e.isLoading,s=function(e){var n=e.sortField,t=e.isLoading,r=(0,y.useSelector)(l.dp),s=(0,y.useDispatch)(),i=(0,a.useState)(I.UNSELECTED),o=i[0],c=i[1],u=(0,a.useState)(!1),d=u[0],h=u[1];return(0,a.useEffect)((function(){t||h(!1)}),[t]),(0,a.useEffect)((function(){void 0===r.sort_direction&&c(I.UNSELECTED)}),[r]),{handleButtonClick:(0,a.useCallback)((function(){switch(h(!0),s((0,l.PU)(n)),o){case I.UNSELECTED:s((0,l.iX)(I.ASC)),c(I.ASC);break;case I.ASC:s((0,l.iX)(I.DESC)),c(I.DESC);break;case I.DESC:s((0,l.p2)()),c(I.UNSELECTED)}}),[o,c,s,n]),buttonState:o,wasButtonJustClicked:d}}({sortField:n,isLoading:t}),i=s.buttonState,o=s.handleButtonClick,u=s.wasButtonJustClicked,d=null;switch(i){case I.ASC:d=(0,c.jsx)(g.HK,{up:!0});break;case I.DESC:d=(0,c.jsx)(g.HK,{up:!1});break;case I.UNSELECTED:default:d=(0,c.jsx)(g.HK,{})}return(0,c.jsx)(r.kC,{paddingLeft:"3px",children:(0,c.jsx)(m.hU,{variant:"ghost","aria-label":"Sort requests",icon:d,isLoading:t&&u,onClick:o})})},Y=function(e){var n=e.revealPII,t=(0,D.T)(),s=(0,D.C)(l.dp),i=(0,D.C)(l.fe),o=i.checkAll,u=i.errorRequests,h=(0,l.QA)(s),x=h.data,f=h.isFetching,p=x||{items:[],total:0},v=p.items,j=p.total,g=(0,a.useCallback)((function(){return v.filter((function(e){return"error"===e.status})).map((function(e){return e.id}))}),[v]),m=function(e,n){var r;r=n?[].concat((0,d.Z)(u),[e]):u.filter((function(n){return n!==e})),t((0,l.uT)({checkAll:n&&o,errorRequests:r}))};return(0,a.useEffect)((function(){var e;f&&null!==(e=s.status)&&void 0!==e&&e.includes("error")&&t((0,l.uT)({checkAll:!1,errorRequests:[]}))}),[t,s.status,f]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(T.iA,{size:"sm","data-testid":"privacy-request-table",children:[(0,c.jsx)(T.hr,{children:(0,c.jsxs)(T.Tr,{children:[(0,c.jsx)(T.Th,{px:0,children:(0,c.jsx)(P.XZ,{"aria-label":"Select all",isChecked:o,isDisabled:!v.some((function(e){return"error"===e.status})),onChange:function(){var e=!o;t((0,l.uT)({checkAll:e,errorRequests:e?g():[]}))}})}),(0,c.jsx)(T.Th,{pl:0,children:"Status"}),(0,c.jsx)(T.Th,{children:(0,c.jsxs)(r.kC,{alignItems:"center",children:["Days Left"," ",(0,c.jsx)(K,{sortField:"due_date",isLoading:f})]})}),(0,c.jsx)(T.Th,{children:"Request Type"}),(0,c.jsx)(T.Th,{children:"Subject Identity"}),(0,c.jsx)(T.Th,{children:"Time Received"}),(0,c.jsx)(T.Th,{children:"Reviewed By"}),(0,c.jsx)(T.Th,{children:"Request ID"}),(0,c.jsx)(T.Th,{})]})}),(0,c.jsx)(T.p3,{children:v.map((function(e){return(0,c.jsx)(W,{isChecked:u.includes(e.id),onCheckChange:m,request:e,revealPII:n},e.id)}))})]}),(0,c.jsx)(Z.Z,{page:s.page,size:s.size,total:j,handleNextPage:function(){t((0,l.YA)(s.page+1))},handlePreviousPage:function(){t((0,l.YA)(s.page-1))}})]})},G=i()((function(){return Promise.all([t.e(6894),t.e(7036)]).then(t.bind(t,67036))}),{loading:function(){return(0,c.jsx)("div",{children:"Loading..."})},loadableGenerated:{webpack:function(){return[67036]}}}),J=function(){var e=function(){var e=(0,o.VY)().errorAlert,n=(0,a.useState)(!1),t=n[0],s=n[1],i=(0,a.useState)({count:0,total:0}),u=i[0],d=i[1],h=(0,a.useState)(!0),x=h[0],f=h[1],p=(0,l.tE)().data,v=(0,l.QA)({status:["error"]},{pollingInterval:15e3,skip:x}).data;return(0,a.useEffect)((function(){f(!(p&&p.notify_after_failures>0))}),[p]),(0,a.useEffect)((function(){var e=(null===v||void 0===v?void 0:v.total)||0;e>=((null===p||void 0===p?void 0:p.notify_after_failures)||0)&&e>u.total?(d({count:e-u.total,total:e}),s(!0)):s(!1)}),[null===v||void 0===v?void 0:v.total,null===p||void 0===p?void 0:p.notify_after_failures,u.total]),{processing:function(){t&&e((0,c.jsxs)(r.xu,{children:["DSR automation has failed for"," ",(0,c.jsx)(r.xv,{as:"span",fontWeight:"semibold",children:u.count})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null,id:"dsrErrorAlert"})}}}(),n=e.processing,t=(0,a.useState)(!1),s=t[0],i=t[1];return(0,a.useEffect)((function(){n()}),[n]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(r.kC,{children:[(0,c.jsx)(r.X6,{mb:8,fontSize:"2xl",fontWeight:"semibold",children:"Privacy Requests"}),(0,c.jsx)(r.LZ,{}),(0,c.jsx)(G,{})]}),(0,c.jsx)(z,{revealPII:s,setRevealPII:i}),(0,c.jsx)(Y,{revealPII:s})]})}}}]);