(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5979],{70783:function(e,t,r){"use strict";r.d(t,{HK:function(){return i},VY:function(){return s.V}});var s=r(63719),n=r(65698),i=function(){var e=(0,s.V)().errorAlert;return{handleError:function(t){var r="An unexpected error occurred. Please try again.";(0,n.Ot)(t)?r=t.data.detail:(0,n.tB)(t)&&(r=t.data.detail[0].msg),e(r)}}};r(67294)},63719:function(e,t,r){"use strict";r.d(t,{V:function(){return d}});var s=r(59499),n=r(13450),i=r(26707),a=r(23256),o=r(93225),c=r(85893);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(){var e=(0,n.pm)();return{errorAlert:function(t,r,s){var n=u(u({},s),{},{position:(null===s||void 0===s?void 0:s.position)||"top",render:function(e){var s=e.onClose;return(0,c.jsxs)(i.bZ,{alignItems:"normal",status:"error",children:[(0,c.jsx)(i.zM,{}),(0,c.jsxs)(a.xu,{children:[r&&(0,c.jsx)(i.Cd,{children:r}),(0,c.jsx)(i.X,{children:t})]}),(0,c.jsx)(o.P,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}});null!==s&&void 0!==s&&s.id&&e.isActive(s.id)?e.update(s.id,n):e(n)},successAlert:function(t,r,s){var n=u(u({},s),{},{position:(null===s||void 0===s?void 0:s.position)||"top",render:function(e){var s=e.onClose;return(0,c.jsxs)(i.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,c.jsx)(i.zM,{}),(0,c.jsxs)(a.xu,{children:[r&&(0,c.jsx)(i.Cd,{children:r}),(0,c.jsx)(i.X,{children:t})]}),(0,c.jsx)(o.P,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}});null!==s&&void 0!==s&&s.id&&e.isActive(s.id)?e.update(s.id,n):e(n)}}}},13850:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var s=r(50029),n=r(16835),i=r(87794),a=r.n(i),o=r(23256),c=r(20440),l=r(93154),u=r(41664),d=r.n(u),h=r(67294),f=r(65698),p=r(70783),m=r(17140),x=r(70918),v=r(43894),j=r(82175),g=r(96016),y=r(85893),b=function(e){var t=e.storageDetails,r=t.auth_method,i=t.bucket,c=t.format,l=(0,h.useState)(""),u=l[0],d=l[1],m=(0,x.gC)(),b=(0,n.Z)(m,1)[0],_=(0,x.cf)(),k=(0,n.Z)(_,1)[0],w=(0,p.HK)().handleError,S=(0,p.VY)().successAlert,C={type:"s3",details:{auth_method:null!==r&&void 0!==r?r:"",bucket:null!==i&&void 0!==i?i:""},format:null!==c&&void 0!==c?c:""},O=function(){var e=(0,s.Z)(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({type:"s3",details:{auth_method:t.details.auth_method,bucket:t.details.bucket},format:t.format});case 2:r=e.sent,(0,f.D4)(r)?w(r.error):(d(t.details.auth_method),S("S3 storage credentials successfully updated."));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=(0,s.Z)(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({aws_access_key_id:t.aws_access_key_id,aws_secret_access_key:t.aws_secret_access_key});case 2:r=e.sent,(0,f.D4)(r)?w(r.error):S("S3 storage secrets successfully updated.");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"S3 storage configuration"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:C,onSubmit:O,children:function(e){var t=e.isSubmitting,r=e.resetForm;return(0,y.jsxs)(j.l0,{children:[(0,y.jsxs)(o.Kq,{mt:5,spacing:5,children:[(0,y.jsx)(g.AP,{name:"format",label:"Format",options:[{label:"json",value:"json"},{label:"csv",value:"csv"}]}),(0,y.jsx)(g.AP,{name:"auth_method",label:"Auth method",options:[{label:"secret_keys",value:"secret_keys"},{label:"automatic",value:"automatic"}]}),(0,y.jsx)(g.j0,{name:"bucket",label:"Bucket",placeholder:"Optional"})]}),(0,y.jsx)(v.zx,{onClick:function(){return r()},mt:5,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{mt:5,isDisabled:t,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})}})}),"secret_keys"===u?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.iz,{mt:5}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:5,children:"Storage destination"}),"Use the key returned in the last step to provide and authenticate your storage destination\u2019s secrets:",(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:{aws_access_key_id:"",aws_secret_access_key:""},onSubmit:z,children:function(e){var t=e.isSubmitting,r=e.resetForm;return(0,y.jsxs)(j.l0,{children:[(0,y.jsxs)(o.Kq,{mt:5,spacing:5,children:[(0,y.jsx)(g.j0,{name:"aws_access_key_ID",label:"AWS access key ID"}),(0,y.jsx)(g.j0,{name:"aws_secret_access_key",label:"AWS secret access key"})]}),(0,y.jsx)(v.zx,{onClick:function(){return r()},mt:5,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{mt:5,isDisabled:t,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})}})})]}):null]})},_=function(){var e=(0,p.VY)().successAlert,t=(0,p.HK)().handleError,r=(0,h.useState)(""),i=r[0],u=r[1],v=(0,x.gC)(),j=(0,n.Z)(v,2),g=j[0],_=j[1].isLoading,k=(0,x.QG)(),w=(0,n.Z)(k,1)[0],S=(0,x.Au)({type:i}).data,C=function(){var r=(0,s.Z)(a().mark((function r(s){var n,i;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("local"!==s){r.next=5;break}return r.next=3,g({type:s,format:"json"});case 3:n=r.sent,(0,f.D4)(n)?t(n.error):e("Configure storage type details saved successfully.");case 5:return r.next=7,w({fides:{storage:{active_default_storage_type:s}}});case 7:i=r.sent,(0,f.D4)(i)?t(i.error):(e("Configure active storage type saved successfully."),u(s));case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return(0,y.jsxs)(m.Z,{title:"Configure Privacy Requests - Storage",children:[(0,y.jsx)(o.xu,{mb:8,children:(0,y.jsxs)(c.aG,{fontWeight:"medium",fontSize:"sm",color:"gray.600",children:[(0,y.jsx)(c.gN,{children:(0,y.jsx)(c.At,{as:d(),href:"/privacy-requests",children:"Privacy requests"})}),(0,y.jsx)(c.gN,{children:(0,y.jsx)(c.At,{as:d(),href:"/privacy-requests/configure",children:"Configuration"})}),(0,y.jsx)(c.gN,{color:"complimentary.500",children:(0,y.jsx)(c.At,{as:d(),href:"/privacy-requests/configure/storage",isCurrentPage:!0,children:"Configure storage"})})]})}),(0,y.jsx)(o.X6,{mb:5,fontSize:"2xl",fontWeight:"semibold",children:"Configure storage"}),(0,y.jsxs)(o.xu,{display:"flex",flexDirection:"column",width:"50%",children:[(0,y.jsx)(o.xu,{mb:5,children:"M3LD requires a storage destination to store and share the results of privacy requests. For a production setup, it is highly recommended to have S3 as a storage destination. Ensure you have completed the setup for the storage destination and have the details handy prior to the following steps."}),(0,y.jsxs)(o.xu,{children:["To configure a Storage destination, first choose a method to store your results. M3LD currently supports"," ",(0,y.jsx)(o.xv,{as:"span",color:"complimentary.500",children:"Local"})," ","and"," ",(0,y.jsx)(o.xv,{as:"span",color:"complimentary.500",children:"S3"})," ","storage methods."]}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose storage type to configure"}),(0,y.jsx)(l.Ee,{isDisabled:_,onChange:C,value:i,"data-testid":"privacy-requests-storage-selection",colorScheme:"secondary",p:3,children:(0,y.jsxs)(o.Kq,{direction:"row",children:[(0,y.jsx)(l.Y8,{value:"local","data-testid":"option-local",mr:5,children:"Local"},"local"),(0,y.jsx)(l.Y8,{value:"s3","data-testid":"option-s3",children:"S3"},"s3")]})}),"s3"===i&&S?(0,y.jsx)(b,{storageDetails:S}):null]})]})},k=function(){return(0,y.jsx)(_,{})}},68821:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/storage",function(){return r(13850)}])}},function(e){e.O(0,[5372,7601,248,2350,6648,440,7140,7080,9774,2888,179],(function(){return t=68821,e(e.s=t);var t}));var t=e.O();_N_E=t}]);