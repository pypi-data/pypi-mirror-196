(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8593],{70783:function(e,i,n){"use strict";n.d(i,{HK:function(){return s},VY:function(){return t.V}});var t=n(63719),r=n(65698),s=function(){var e=(0,t.V)().errorAlert;return{handleError:function(i){var n="An unexpected error occurred. Please try again.";(0,r.Ot)(i)?n=i.data.detail:(0,r.tB)(i)&&(n=i.data.detail[0].msg),e(n)}}};n(67294)},63719:function(e,i,n){"use strict";n.d(i,{V:function(){return d}});var t=n(59499),r=n(13450),s=n(26707),o=n(23256),a=n(93225),l=n(85893);function c(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);i&&(t=t.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),n.push.apply(n,t)}return n}function u(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?c(Object(n),!0).forEach((function(i){(0,t.Z)(e,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))}))}return e}var d=function(){var e=(0,r.pm)();return{errorAlert:function(i,n,t){var r=u(u({},t),{},{position:(null===t||void 0===t?void 0:t.position)||"top",render:function(e){var t=e.onClose;return(0,l.jsxs)(s.bZ,{alignItems:"normal",status:"error",children:[(0,l.jsx)(s.zM,{}),(0,l.jsxs)(o.xu,{children:[n&&(0,l.jsx)(s.Cd,{children:n}),(0,l.jsx)(s.X,{children:i})]}),(0,l.jsx)(a.P,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});null!==t&&void 0!==t&&t.id&&e.isActive(t.id)?e.update(t.id,r):e(r)},successAlert:function(i,n,t){var r=u(u({},t),{},{position:(null===t||void 0===t?void 0:t.position)||"top",render:function(e){var t=e.onClose;return(0,l.jsxs)(s.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,l.jsx)(s.zM,{}),(0,l.jsxs)(o.xu,{children:[n&&(0,l.jsx)(s.Cd,{children:n}),(0,l.jsx)(s.X,{children:i})]}),(0,l.jsx)(a.P,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});null!==t&&void 0!==t&&t.id&&e.isActive(t.id)?e.update(t.id,r):e(r)}}}},32607:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return k}});var t=n(50029),r=n(16835),s=n(87794),o=n.n(s),a=n(23256),l=n(20440),c=n(93154),u=n(41664),d=n.n(u),m=n(67294),p=n(65698),h=n(70783),f=n(17140),x=n(70918),v=n(43894),g=n(82175),j=n(96016),y=n(85893),_=function(){var e,i,n=(0,h.VY)().successAlert,s=(0,m.useState)(""),l=s[0],c=s[1],u=(0,h.HK)().handleError,d=(0,x.S3)({type:"mailgun"}).data,f=(0,x.h9)(),_=(0,r.Z)(f,1)[0],b=(0,x.iI)(),w=(0,r.Z)(b,1)[0],S=function(){var e=(0,t.Z)(o().mark((function e(i){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({type:"mailgun",details:{is_eu_domain:"false",domain:i.domain}});case 2:t=e.sent,(0,p.D4)(t)?u(t.error):(n("Mailgun email successfully updated. You can now enter your security key."),c("apiKey"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),k=function(){var e=(0,t.Z)(o().mark((function e(i){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({mailgun_api_key:i.api_key});case 2:t=e.sent,(0,p.D4)(t)?u(t.error):n("Mailgun security key successfully updated.");case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),z={domain:null!==(e=null===d||void 0===d?void 0:d.details.domain)&&void 0!==e?e:""},C={api_key:null!==(i=null===d||void 0===d?void 0:d.key)&&void 0!==i?i:""};return(0,y.jsxs)(a.xu,{children:[(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Mailgun messaging configuration"}),(0,y.jsx)(a.Kq,{children:(0,y.jsx)(g.J9,{initialValues:z,onSubmit:S,children:function(e){var i=e.isSubmitting,n=e.resetForm;return(0,y.jsxs)(g.l0,{children:[(0,y.jsx)(a.Kq,{mt:5,spacing:5,children:(0,y.jsx)(j.j0,{name:"domain",label:"Domain",placeholder:"Enter domain"})}),(0,y.jsxs)(a.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return n()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})}),"apiKey"===l?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a.iz,{}),(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,y.jsx)(a.Kq,{children:(0,y.jsx)(g.J9,{initialValues:C,onSubmit:k,children:function(e){var i=e.isSubmitting,n=e.resetForm;return(0,y.jsxs)(g.l0,{children:[(0,y.jsx)(j.j0,{name:"api_key",label:"API key",placeholder:"Optional",type:"password"}),(0,y.jsx)(v.zx,{onClick:function(){return n()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})}})})]}):null]})},b=function(){var e,i,n=(0,m.useState)(""),s=n[0],l=n[1],c=(0,h.VY)().successAlert,u=(0,h.HK)().handleError,d=(0,x.S3)({type:"twilio_email"}).data,f=(0,x.h9)(),_=(0,r.Z)(f,1)[0],b=(0,x.iI)(),w=(0,r.Z)(b,1)[0],S=function(){var e=(0,t.Z)(o().mark((function e(i){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({type:"twilio_email",details:{twilio_email_from:i.email}});case 2:n=e.sent,(0,p.D4)(n)?u(n.error):(c("Twilio email successfully updated. You can now enter your security key."),l("configureTwilioEmailSecrets"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),k=function(){var e=(0,t.Z)(o().mark((function e(i){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({twilio_api_key:i.api_key});case 2:n=e.sent,(0,p.D4)(n)?u(n.error):(c("Twilio email secrets successfully updated."),l("configureTwilioEmailSecrets"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),z={email:null!==(e=null===d||void 0===d?void 0:d.email)&&void 0!==e?e:""},C={api_key:null!==(i=null===d||void 0===d?void 0:d.key)&&void 0!==i?i:""};return(0,y.jsxs)(a.xu,{children:[(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio Email messaging configuration"}),(0,y.jsx)(a.Kq,{children:(0,y.jsx)(g.J9,{initialValues:z,onSubmit:S,children:function(e){var i=e.isSubmitting,n=e.resetForm;return(0,y.jsxs)(g.l0,{children:[(0,y.jsx)(a.Kq,{mt:5,spacing:5,children:(0,y.jsx)(j.j0,{name:"email",label:"Email",placeholder:"Enter email"})}),(0,y.jsxs)(a.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return n()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})}),"configureTwilioEmailSecrets"===s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a.iz,{}),(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,y.jsx)(a.Kq,{children:(0,y.jsx)(g.J9,{initialValues:C,onSubmit:k,children:function(e){var i=e.isSubmitting,n=e.resetForm;return(0,y.jsxs)(g.l0,{children:[(0,y.jsx)(a.Kq,{mt:5,spacing:5,children:(0,y.jsx)(j.j0,{name:"api-key",label:"API key",type:"password"})}),(0,y.jsx)(v.zx,{onClick:function(){return n()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})}})})]}):null]})},w=function(){var e,i,n,s,l=(0,h.VY)().successAlert,c=(0,h.HK)().handleError,u=(0,x.S3)({type:"twilio_text"}).data,d=(0,x.iI)(),m=(0,r.Z)(d,1)[0],f=function(){var e=(0,t.Z)(o().mark((function e(i){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({twilio_account_sid:i.account_sid,twilio_auth_token:i.auth_token,twilio_messaging_service_sid:i.messaging_service_sid,twilio_sender_phone_number:i.phone});case 2:n=e.sent,(0,p.D4)(n)?c(n.error):l("Twilio text secrets successfully updated.");case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),_={account_sid:null!==(e=null===u||void 0===u?void 0:u.twilio_account_sid)&&void 0!==e?e:"",auth_token:null!==(i=null===u||void 0===u?void 0:u.twilio_auth_token)&&void 0!==i?i:"",messaging_service_sid:null!==(n=null===u||void 0===u?void 0:u.twilio_messaging_service_sid)&&void 0!==n?n:"",phone:null!==(s=null===u||void 0===u?void 0:u.twilio_sender_phone_number)&&void 0!==s?s:""};return(0,y.jsxs)(a.xu,{children:[(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio SMS messaging configuration"}),(0,y.jsx)(a.Kq,{children:(0,y.jsx)(g.J9,{initialValues:_,onSubmit:f,children:function(e){var i=e.isSubmitting,n=e.resetForm;return(0,y.jsxs)(g.l0,{children:[(0,y.jsxs)(a.Kq,{mt:5,spacing:5,children:[(0,y.jsx)(j.j0,{name:"account_sid",label:"Account SID",placeholder:"Enter account SID"}),(0,y.jsx)(j.j0,{name:"auth_token",label:"Auth token",placeholder:"Enter auth token",type:"password"}),(0,y.jsx)(j.j0,{name:"messaging_service_sid",label:"Messaging Service SID",placeholder:"Enter messaging service SID"}),(0,y.jsx)(j.j0,{name:"phone",label:"Phone Number",placeholder:"Enter phone number"})]}),(0,y.jsxs)(a.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return n()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})})]})},S=function(){var e=(0,h.VY)().successAlert,i=(0,h.HK)().handleError,n=(0,m.useState)(""),s=n[0],u=n[1],v=(0,x.h9)(),g=(0,r.Z)(v,1)[0],j=(0,x.QG)(),S=(0,r.Z)(j,1)[0],k=function(){var n=(0,t.Z)(o().mark((function n(t){var r,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S({fides:{notifications:{notification_service_type:t,send_request_completion_notification:!0,send_request_receipt_notification:!0,send_request_review_notification:!0,subject_identity_verification_required:!0}}});case 2:if(r=n.sent,!(0,p.D4)(r)){n.next=7;break}i(r.error),n.next=16;break;case 7:if("twilio_text"===t){n.next=12;break}e("Configured storage type successfully."),u(t),n.next=16;break;case 12:return n.next=14,g({type:"twilio_text"});case 14:s=n.sent,(0,p.D4)(s)?i(s.error):(e("Configure messaging provider saved successfully."),u(t));case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,y.jsxs)(f.Z,{title:"Configure Privacy Requests - Messaging",children:[(0,y.jsx)(a.xu,{mb:8,children:(0,y.jsxs)(l.aG,{fontWeight:"medium",fontSize:"sm",color:"gray.600",children:[(0,y.jsx)(l.gN,{children:(0,y.jsx)(l.At,{as:d(),href:"/privacy-requests",children:"Privacy requests"})}),(0,y.jsx)(l.gN,{children:(0,y.jsx)(l.At,{as:d(),href:"/privacy-requests/configure",children:"Configuration"})}),(0,y.jsx)(l.gN,{color:"complimentary.500",children:(0,y.jsx)(l.At,{as:d(),href:"/privacy-requests/configure/messaging",isCurrentPage:!0,children:"Configure messaging provider"})})]})}),(0,y.jsx)(a.X6,{mb:5,fontSize:"2xl",fontWeight:"semibold",children:"Configure your messaging provider"}),(0,y.jsxs)(a.xu,{display:"flex",flexDirection:"column",width:"50%",children:[(0,y.jsxs)(a.xu,{children:["M3LD requires a messsaging provider for sending processing notices to privacy request subjects, and allows for Subject Identity Verification in privacy requests. Please follow the"," ",(0,y.jsx)(a.xv,{as:"span",color:"complimentary.500",children:"documentation"})," ","to setup a messaging service that M3LD supports. Ensure you have completed the setup for the preferred messaging provider and have the details handy prior to the following steps."]}),(0,y.jsx)(a.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose service type to configure"}),(0,y.jsx)(c.Ee,{onChange:k,value:s,"data-testid":"privacy-requests-messaging-provider-selection",colorScheme:"secondary",p:3,children:(0,y.jsxs)(a.Kq,{direction:"row",children:[(0,y.jsx)(c.Y8,{value:"mailgun-email","data-testid":"option-mailgun-email",mr:5,children:"Mailgun email"},"mailgun-email"),(0,y.jsx)(c.Y8,{value:"twilio-email","data-testid":"option-twilio-email",children:"Twilio email"},"twilio-email"),(0,y.jsx)(c.Y8,{value:"twilio-text","data-testid":"option-twilio-text",children:"Twilio sms"},"twilio-text")]})}),"mailgun-email"===s?(0,y.jsx)(_,{}):null,"twilio-email"===s?(0,y.jsx)(b,{}):null,"twilio-text"===s?(0,y.jsx)(w,{}):null]})]})},k=function(){return(0,y.jsx)(S,{})}},68528:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/messaging",function(){return n(32607)}])}},function(e){e.O(0,[5372,7601,248,2350,6648,440,7140,7080,9774,2888,179],(function(){return i=68528,e(e.s=i);var i}));var i=e.O();_N_E=i}]);